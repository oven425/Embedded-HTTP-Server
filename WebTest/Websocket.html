<!DOCTYPE html>
<html>
    <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>WebSocket Test</title>
        <style>
        </style>
    </head>
    <body>
        <div>
            <strong>Location:</strong>
            <br></br>
            <!-- <input id="input_url" value="ws://echo.websocket.org"></input> -->
            <input id="input_url" value="ws://10.1.1.246:3333/WEBSOCKET_TEST"></input>
            <br></br>
            <button id="button_connect" onclick="onconnect()">Connect</button>
            <button id="button_disconnect" onclick="ondisconnect()">Disconnect</button>
            <button id="button_ping" onclick="onping()">Ping</button>
            <br></br>
            <strong>Message:</strong>
            <br></br>
            <input id="input_senddata" value="send~~"></input>
            <br></br>
            <button id="button_send" onclick="onsend()">Send</button>
            
        </div>
        <div>
            <strong>Log:</strong>
            <br/>
            <div id="consolelog"></div>
            <button id="button_clearlog" onclick="onclearlog()">Clear Log</button>
        </div>
        <script>
            var websocket;
            function onconnect()
            {
                var input_url = document.getElementById("input_url");
                websocket = new WebSocket(input_url.value);
                websocket.onopen=function(evt) { onwebsocketopen(evt) };
                websocket.onclose=function(evt) { onwebsocketclose(evt) };
                websocket.onmessage=function(evt) { onwebsocketrecv(evt) };
            }

            function ondisconnect()
            {
                websocket.close();
            }

            function onping()
            {
                //websocket.ping();
            }

            function onsend()
            {
                var input = document.getElementById("input_senddata");
                
                websocket.send(input.value);
            }

            function onwebsocketrecv(evt)
            {
                var consoleLog = document.getElementById("consolelog");
                var p = document.createElement('p');
    p.style.wordWrap = 'break-word';
    p.innerText=evt.data;

    consoleLog.appendChild(p);

    while (consoleLog.childNodes.length > 50)
    {
      consoleLog.removeChild(consoleLog.firstChild);
    }

    consoleLog.scrollTop = consoleLog.scrollHeight;
            }

            function onwebsocketclose(evt)
            {
                var consoleLog = document.getElementById("consolelog");
                var p = document.createElement('p');
    p.style.wordWrap = 'break-word';
    p.innerText="DisConnect";

    consoleLog.appendChild(p);

    while (consoleLog.childNodes.length > 50)
    {
      consoleLog.removeChild(consoleLog.firstChild);
    }

    consoleLog.scrollTop = consoleLog.scrollHeight;
            }

            function onwebsocketopen(evt)
            {
                var consoleLog = document.getElementById("consolelog");
                var p = document.createElement('p');
    p.style.wordWrap = 'break-word';
    p.innerText="Connect";

    consoleLog.appendChild(p);

    while (consoleLog.childNodes.length > 50)
    {
      consoleLog.removeChild(consoleLog.firstChild);
    }

    consoleLog.scrollTop = consoleLog.scrollHeight;
            }

            function onclearlog()
            {
                var consoleLog = document.getElementById("consolelog");

                // As long as <ul> has a child node, remove it
                while (consoleLog.hasChildNodes()) {   
                    consoleLog.removeChild(consoleLog.firstChild);
                }
            }
       </script>
    </body>
</html>
